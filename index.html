<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
  />
  <title>AR Camera</title>
  <style>
    :root { --bottomnavH: 72px; }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background:#000; color:#fff; min-height:100dvh; overflow:hidden;
    }
    .hidden{ display:none !important; }

    /* Views */
    .view { min-height:100dvh; padding-bottom: var(--bottomnavH); }

    /* Camera */
    .camera-container {
      position:relative;
      width:100vw;
      height: calc(100dvh - var(--bottomnavH));
      background:#000;
      overflow:hidden;
    }
    #live-canvas { width:100%; height:100%; object-fit:cover; display:block; background:#000; }

    /* Capture button (top-right) */
    .capture-button {
      position:absolute; top:16px; right:16px; z-index:10;
      background: rgba(255, 59, 48, 0.85);
      color:#fff; border:2px solid rgba(255, 59, 48, 0.95);
      width:52px; height:52px; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer; backdrop-filter: blur(10px);
      -webkit-tap-highlight-color: transparent;
    }
    .capture-button::after { content:"ðŸ“·"; font-size:1.2rem; }

    /* Preview overlay */
    .photo-preview {
      position:absolute; inset:0; background:#000; display:none; z-index:20;
      align-items:center; justify-content:center; flex-direction:column;
    }
    .photo-preview.show{ display:flex; }
    .photo-preview img { max-width:100%; max-height:100%; object-fit:contain; }
    .photo-preview-controls {
      position:absolute; bottom:24px; left:50%; transform:translateX(-50%);
      display:flex; gap:16px;
    }
    .preview-button {
      background: rgba(255,255,255,0.92);
      color:#000; border:0; border-radius:24px; padding:10px 16px; font-weight:600;
    }
    .preview-button.download { background: rgba(0,122,255,0.95); color:#fff; }

    /* Backpack (Gallery) */
    .bag-grid{
      max-width:980px;margin: 14px auto 0; padding: 0 14px;
      display:grid; gap:14px; grid-template-columns: repeat(auto-fit, minmax(110px,1fr));
    }
    .bag-item{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 12px;
      padding:10px; text-align:center;
    }
    .bag-thumb{
      width:100%; aspect-ratio:1/1; border-radius:10px;
      background:#111 center/cover no-repeat; margin-bottom:8px;
    }
    .muted{ color:#ccc; text-align:center; margin-top:12px; }

    /* Settings */
    .settings-list{
      max-width: 980px; margin: 14px auto 0; padding: 0 14px;
      display:flex; flex-direction:column; gap:12px;
    }
    .setting{
      display:flex; align-items:center; justify-content:space-between;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.1);
      padding:12px 14px; border-radius:12px;
    }
    .danger-btn{
      background:#e74c3c; color:#fff; border:0; padding:12px 16px; border-radius:12px; font-weight:700;
    }

    /* Bottom navigation */
    .bottom-nav{
      position:fixed; left:0; right:0; bottom:0; z-index:30;
      display:grid; grid-template-columns:repeat(4,1fr);
      background: rgba(18,19,23,.9); backdrop-filter: blur(10px);
      border-top:1px solid rgba(255,255,255,.12);
      min-height: var(--bottomnavH); padding:8px 10px;
    }
    .nav-btn{
      appearance:none; border:0; background:transparent; color:#fff; cursor:pointer;
      display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px;
      -webkit-tap-highlight-color: transparent;
    }
    .nav-btn .icon{ width:28px; height:28px; display:block; }
    .nav-btn .icon img{ width:100%; height:100%; object-fit:contain; display:block; }
    .nav-btn .label{ font-size:12px; opacity:.9 }
    .nav-btn.active .label{ font-weight:700; opacity:1 }
  </style>
</head>
<body>

  <!-- CAMERA VIEW -->
  <main id="camera-view" class="view">
    <div class="camera-container">
      <!-- Placeholder replaced by Camera Kit live canvas -->
      <div id="canvas-output">Startingâ€¦</div>

      <!-- Capture -->
      <button class="capture-button" id="captureButton" title="Capture Photo"></button>

      <!-- Preview -->
      <div class="photo-preview" id="photoPreview">
        <img id="previewImage" alt="Captured Photo" />
        <div class="photo-preview-controls">
          <button class="preview-button" id="retakeButton">âœ•</button>
          <button class="preview-button download" id="saveButton">ðŸ“¤</button>
        </div>
      </div>
    </div>
  </main>

  <!-- GALLERY (Backpack) -->
  <section id="backpack-view" class="view hidden" aria-label="Backpack">
    <h2 style="padding:14px;">Gallery</h2>
    <div id="bag-grid" class="bag-grid"></div>
    <p class="muted hidden" id="bag-empty">You havenâ€™t collected anything yet.</p>
  </section>

  <!-- SETTINGS -->
  <section id="settings-view" class="view hidden" aria-label="Settings">
    <h2 style="padding:14px;">Settings</h2>
    <div class="settings-list">
      <label class="setting">
        <span>High quality rendering</span>
        <input type="checkbox" id="hq-toggle" />
      </label>
      <label class="setting">
        <span>Mute shutter sound</span>
        <input type="checkbox" id="mute-toggle" />
      </label>
      <button id="btn-reset-app" class="danger-btn" aria-label="Reset App">Reset App (Clear Gallery)</button>
    </div>
  </section>

  <!-- BOTTOM NAV (with icons from images/) -->
  <nav class="bottom-nav" aria-label="Primary">
    <button id="tab-bayou" class="nav-btn active" data-tab="bayou">
      <span class="icon"><img src="public/images/alligator.png" alt="Bayou" /></span>
      <span class="label">Bayou</span>
    </button>
    <button id="tab-photo" class="nav-btn" data-tab="photo" aria-label="Photo Booth">
      <span class="icon"><img src="public/images/photo.png" alt="Photo Booth" /></span>
      <span class="label">Photo-Booth</span>
    </button>
    <button id="tab-bag" class="nav-btn" data-tab="bag" aria-label="Backpack">
      <span class="icon"><img src="public/images/backpack.png" alt="Gallery" /></span>
      <span class="label">Gallery</span>
    </button>
    <button id="tab-settings" class="nav-btn" data-tab="settings" aria-label="Settings">
      <span class="icon"><img src="public/images/settings.png" alt="Settings" /></span>
      <span class="label">Settings</span>
    </button>
  </nav>

  <!-- Background Audio -->
  <audio id="backgroundAudio" loop preload="auto">
    <source src="bayouaudio_fixed.mp3" type="audio/mp3" />
  </audio>

  <script type="module" src="./proper.js"></script>
</body>
</html>
